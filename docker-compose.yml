version: "3.8"

services:
  app:
    build:
      context: . # Build Dockerfile in the current directory
      dockerfile: Dockerfile
    ports:
      - "3000:3000" # Map container port 3000 to host port 3000
    environment:
      DISCORD_TOKEN: "${DISCORD_TOKEN}" # Pass environment variables from .env file
      CHANNEL_ID: "${CHANNEL_ID}"
      PORT: "${PORT}"
    volumes:
      - .:/usr/src/app # Bind mount current directory for live updates (optional)
    depends_on:
      - puppeteer
    restart: always

  puppeteer:
    image: "browserless/chrome:latest" # Puppeteer base image with preinstalled Chrome
    environment:
      - ENABLE_DEBUGGER=false
    ports:
      - "3001:3000" # Expose debugger (optional)
